<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="shortcut icon" href="../img/logo.png">
    <link rel="stylesheet" href="../node_modules/bulma/css/bulma.min.css">
    <title>สมัครสมาชิก</title>

</head>

<body>
    <script src="../node_modules/axios/dist/axios.min.js"></script>
    <script>
        var idText, postText, telText, email, password, cfpassword, name, lastname, date, address, tumbon, aumper, city, sex, department, username
        var flag = true;
        function isNumber(e) {
            e = e || window.event;
            var charCode = e.which ? e.which : e.keyCode;
            idLength = e.key
            return /\d/.test(String.fromCharCode(charCode));
        }
        function checkEmail() {
            var re = /^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
            if (re.test(document.getElementById("email").value)) {
                email = document.getElementById("email").value;
                document.getElementById("email").style.border = "";
                document.getElementById("pEmail").style.display = "none";
            } else {
                flag = false;
                document.getElementById("email").style.border = "2px solid red";
                document.getElementById("pEmail").style.display = "block";
            }
        }
        function checkPassword() {
            password = document.getElementById("password").value;
            cfpassword = document.getElementById("repassword").value;
            if (password === cfpassword) {
                document.getElementById("password").style.border = "";
                document.getElementById("repassword").style.border = "";
                document.getElementById("pPassword").style.display = "none";
            } else {
                document.getElementById("password").style.border = "2px solid red";
                document.getElementById("repassword").style.border = "2px solid red";
                document.getElementById("pPassword").style.display = "block";
            }
        }
        function cancel() {
            window.location.href = "../ล็อกอิน.html";
        }
        function submit() {
            idText = document.getElementById('id').value
            username = document.getElementById('username').value;
            postText = document.getElementById("post").value;
            telText = document.getElementById("mobile").value;
            name = document.getElementById("name").value;
            lastname = document.getElementById("lastname").value;
            date = document.getElementById("datepicker").value;
            address = document.getElementById("address").value;
            tumbon = document.getElementById("tumbon").value;
            aumper = document.getElementById("aumphoe").value;
            city = document.getElementById("city").value;
            sex = document.getElementById("sex").value;
            department = document.getElementById("department").value;
            if (idText !== undefined && username !== undefined && postText !== undefined && telText !== undefined && email !== undefined
                && password !== undefined && name !== undefined && lastname !== undefined && date !== undefined
                && address !== undefined && tumbon !== undefined && aumper !== undefined && city !== undefined
                && sex !== undefined) {
                var data = {
                    username: username, password: password, email: email, name: name, lastname: lastname, address: address, tumbon: tumbon,
                    aumphoe: aumper, city: city, sex: sex, department: department, post: postText, mobile: telText, date: date, id: idText
                }
                if (password == cfpassword) {
                    axios.post("http://localhost:4001/setEmployee", data).then((res) => {
                        if (res.data.status) {
                            alert("สมัครสมาชิกเรียบร้อย")
                            document.getElementById("username").style.border = "";
                            document.getElementById("pId").style.display = "none";
                            window.location.reload();
                        } else {
                            document.getElementById("username").style.border = "2px solid red";
                            document.getElementById("pId").style.display = "block";
                        }
                    })
                }else{
                    alert("กรุณาใส่ Password ให้ถูกต้อง")
                }
            } else {
                alert("กรุณาใส่ข้อมูลให้ครบทุกช่อง")
            }
        }
    </script>
    <div class="container">
        <br />
        <center>
            <h1 class="title"> สมัครสมาชิก </h1>
        </center>
        <br /><br /><br />
        <div class="columns">
            <div class="column">
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">Username</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="username" class="input" type="text" placeholder="username">
                            </div>
                            <p id="pId" class="help is-danger" style="display:none">
                                username นี้มีผู้ใช้แล้ว
                            </p>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">Password</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="password" class="input" type="password" placeholder="password"
                                    onchange="checkPassword()">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">Re-Password</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="repassword" class="input" type="password" placeholder="re-password"
                                    onchange="checkPassword()">
                            </div>
                            <p id="pPassword" class="help is-danger" style="display:none">
                                password ไม่ตรงกัน
                            </p>
                        </div>
                    </div>
                </div>
                <div class="field">
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">Email</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    <input id="email" class="input" type="text" placeholder="email"
                                        onchange="checkEmail()">
                                </div>
                                <p id="pEmail" class="help is-danger" style="display:none">
                                    อีเมลล์ไม่ถูกต้อง
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">ที่อยู่</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="address" class="input" type="text" placeholder="ที่อยู่">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">อำเภอ</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="aumphoe" class="input" type="text" placeholder="อำเภอ">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">เบอร์โทรศัพท์</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="mobile" class="input" type="text" placeholder="เบอร์โทรศัพท์" maxlength="10"
                                    onkeypress="return isNumber(event);">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">แผนก</label>
                    </div>
                    <div class="field-body">
                        <div class="field ">
                            <p class="control ">
                                <span class="select is-fullwidth">
                                    <select required id="department">
                                        <option disabled selected hidden>เลือก... </option>
                                        <option value="ขาย">ขาย</option>
                                        <option value="ซื้อ">ซื้อ</option>
                                        <option value="ช่าง">ช่าง</option>
                                        <option value="ธุรการ">ธุรการ</option>
                                        <option value="ประชาสัมพันธ์">ประชาสัมพันธ์</option>
                                    </select>
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="column">
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">ชื่อ</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="name" class="input" type="text" placeholder="ชื่อ">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">นามสกุล</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="lastname" class="input" type="text" placeholder="นามสกุล">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">วัน/เดือน/ปี</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="datepicker" class="input" type="date" placeholder="">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">บัตรประชาชน</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="id" class="input" type="text" placeholder="เลขบัตรประชาชน" maxlength="13"
                                    onkeypress="return isNumber(event);">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">ตำบล</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="tumbon" class="input" type="text" placeholder="ตำบล">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">จังหวัด</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="city" class="input" type="text" placeholder="จังหวัด">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">รหัสไปรษณีย์</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input id="post" class="input" type="text" placeholder="รหัสไปรษณีย์" maxlength="5"
                                    onkeypress="return isNumber(event);">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label">เพศ</label>
                    </div>
                    <div class="field-body">
                        <div class="field ">
                            <p class="control ">
                                <span class="select is-fullwidth">
                                    <select required id="sex">
                                        <option disabled selected hidden>เลือก... </option>
                                        <option value="ชาย">ชาย</option>
                                        <option value="หญิง">หญิง</option>
                                        <option value="อื่นๆ">อื่นๆ</option>
                                    </select>
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br /><br /><br />
        <div class="buttons  is-right">
            <a class="button is-info is-outlined" style="width:10%" onclick="submit()">ตกลง</a>
            <a class="button is-info is-outlined" style="width:10%" onclick="cancel()">ยกเลิก</a>
        </div>
    </div>
</body>



</html>