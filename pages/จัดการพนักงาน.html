<!DOCTYPE html>
<html>

<head>
    <title>จัดการพนักงาน</title>
    <link rel="stylesheet" href="../node_modules/bulma/css/bulma.min.css" class="rel">
    <link rel="stylesheet" href="../node_modules/bulma-divider/dist/css/bulma-divider.min.css" class="rel">
    <link rel="stylesheet" href="../node_modules/@fortawesome/fontawesome-free/css/all.css" class="rel">
    <link rel="shortcut icon" href="../img/logo.png" />
</head>

<body>
    <script>
        var selectedRow = null


        function onFormSubmit() {
            if (validate()) {
                var formData = readFormData();
                if (selectedRow == null)
                    insertNewRecord(formData);
                else
                    updateRecord(formData);
                resetForm();
            }
        }

        function readFormData() {
            var formData = {};
            formData["name"] = document.getElementById("name").value;
            formData["lastname"] = document.getElementById("lastname").value;
            formData["datepicker"] = document.getElementById("datepicker").value;
            formData["sex"] = document.getElementById("sex").value;
            formData["id"] = document.getElementById("id").value;
            formData["email"] = document.getElementById("email").value;
            formData["username"] = document.getElementById("username").value;
            formData["password"] = document.getElementById("password").value;
            formData["address"] = document.getElementById("address").value;
            formData["tumbon"] = document.getElementById("tumbon").value;
            formData["aumper"] = document.getElementById("aumper").value;
            formData["city"] = document.getElementById("city").value;
            formData["post"] = document.getElementById("post").value;
            formData["tel"] = document.getElementById("tel").value;

            return formData;
        }

        function insertNewRecord(data) {
            var table = document.getElementById("employeeList").getElementsByTagName('tbody')[0];
            var newRow = table.insertRow(table.length);
            cell1 = newRow.insertCell(0);
            cell1.innerHTML = data.name;
            cell2 = newRow.insertCell(1);
            cell2.innerHTML = data.lastname;
            cell3 = newRow.insertCell(2);
            cell3.innerHTML = data.datepicker;
            cell4 = newRow.insertCell(3);
            cell4.innerHTML = data.sex;
            cell5 = newRow.insertCell(4);
            cell5.innerHTML = data.id;
            cell6 = newRow.insertCell(5);
            cell6.innerHTML = data.email;
            cell7 = newRow.insertCell(6);
            cell7.innerHTML = data.username;
            cell8 = newRow.insertCell(7);
            cell8.innerHTML = data.password;
            cell9 = newRow.insertCell(8);
            cell9.innerHTML = data.address;
            cell10 = newRow.insertCell(9);
            cell10.innerHTML = data.tumbon;
            cell11 = newRow.insertCell(10);
            cell11.innerHTML = data.aumper;
            cell12 = newRow.insertCell(11);
            cell12.innerHTML = data.city;
            cell13 = newRow.insertCell(12);
            cell13.innerHTML = data.post;
            cell14 = newRow.insertCell(13);
            cell14.innerHTML = data.tel;
            cell15 = newRow.insertCell(14);
            cell15.innerHTML = `<a onClick="openForm();onEdit(this)">Edit</a>
                       <a onClick="onDelete(this)">Delete</a>`;
        }

        function resetForm() {
            document.getElementById("name").value = "";
            document.getElementById("lastname").value = "";
            document.getElementById("datepicker").value = "";
            document.getElementById("sex").value = "";
            document.getElementById("id").value = "";
            document.getElementById("email").value = "";
            document.getElementById("username").value = "";
            document.getElementById("password").value = "";
            document.getElementById("address").value = "";
            document.getElementById("tumbon").value = "";
            document.getElementById("aumper").value = "";
            document.getElementById("city").value = "";
            document.getElementById("post").value = "";
            document.getElementById("tel").value = "";
            selectedRow = null;
        }

        function onEdit(td) {
            selectedRow = td.parentElement.parentElement;
            document.getElementById("name").value = selectedRow.cells[0].innerHTML;
            document.getElementById("lastname").value = selectedRow.cells[1].innerHTML;
            document.getElementById("datepicker").value = selectedRow.cells[2].innerHTML;
            document.getElementById("sex").value = selectedRow.cells[3].innerHTML;
            document.getElementById("id").value = selectedRow.cells[4].innerHTML;
            document.getElementById("email").value = selectedRow.cells[5].innerHTML;
            document.getElementById("username").value = selectedRow.cells[6].innerHTML;
            document.getElementById("password").value = selectedRow.cells[7].innerHTML;
            document.getElementById("address").value = selectedRow.cells[8].innerHTML;
            document.getElementById("tumbon").value = selectedRow.cells[9].innerHTML;
            document.getElementById("aumper").value = selectedRow.cells[10].innerHTML;
            document.getElementById("city").value = selectedRow.cells[11].innerHTML;
            document.getElementById("post").value = selectedRow.cells[12].innerHTML;
            document.getElementById("tel").value = selectedRow.cells[13].innerHTML;
        }
        function updateRecord(formData) {
            selectedRow.cells[0].innerHTML = formData.name;
            selectedRow.cells[1].innerHTML = formData.lastname;
            selectedRow.cells[2].innerHTML = formData.datepicker;
            selectedRow.cells[3].innerHTML = formData.sex;
            selectedRow.cells[4].innerHTML = formData.id;
            selectedRow.cells[5].innerHTML = formData.email;
            selectedRow.cells[6].innerHTML = formData.username;
            selectedRow.cells[7].innerHTML = formData.password;
            selectedRow.cells[8].innerHTML = formData.address;
            selectedRow.cells[9].innerHTML = formData.tumbon;
            selectedRow.cells[10].innerHTML = formData.aumper;
            selectedRow.cells[11].innerHTML = formData.city;
            selectedRow.cells[12].innerHTML = formData.post;
            selectedRow.cells[13].innerHTML = formData.tel;
        }

        function onDelete(td) {
            if (confirm('Are you sure to delete this record ?')) {
                row = td.parentElement.parentElement;
                document.getElementById("employeeList").deleteRow(row.rowIndex);
            }
        }
        function openForm() {
            document.getElementById("myForm").style.display = "block";
            resetForm()
        }
        function closeForm() {
            document.getElementById("myForm").style.display = "none";
            resetForm()
        }
        function isNumber(e) {
            e = e || window.event;
            var charCode = e.which ? e.which : e.keyCode;
            idLength = e.key
            return /\d/.test(String.fromCharCode(charCode));
        }
        function checkEmail() {
            var re = /^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
            if (re.test(document.getElementById("email").value)) {
                email = document.getElementById("email").value;
                document.getElementById("email").style.border = "";
            } else {
                flag = false;
                document.getElementById("email").style.border = "2px solid red";
            }
        }

        function validate() {
            isValid = true;
            if (document.getElementById("name").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("lastname").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("datepicker").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("sex").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("id").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("email").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("username").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("password").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("address").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("tumbon").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("aumper").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("city").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("post").value == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else if (document.getElementById("tel").tel == "") {
                isValid = false;
                alert("กรุณากรอกข้อมูลให้ครบ")
            } else {
                isValid = true;
                alert("สำเร็จ")
            }
            return isValid;
        }

    </script>
    <nav class="navbar is-info" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="#">
                <img src="../img/logo.png" width="112" height="28">
            </a>

            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
                data-target="navbarBasicExample">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>

        <div id="navbarBasicExample" class="navbar-menu">
            <div class="navbar-start">
                <a class="navbar-item" href="./หน้าหลัก.html">หน้าหลัก</a>
                <a class="navbar-item" href="./ซื้อรถ.html">ซื้อรถ</a>
                <a class="navbar-item" href="./หน้าขาย1.html">ขายรถ</a>
                <a class="navbar-item" href="./เดินทะเบียน.html">ทะเบียน</a>
                <a class="navbar-item is-active" href="./จัดการพนักงาน.html">จัดการพนักงาน</a>
                <a class="navbar-item" href="./ข้อมูลซ่อมรถ.html">ซ่อม</a>
                <a class="navbar-item" href="./ค้นหาลูกค้า.html">ลูกค้า</a>

            </div>
            <div class="navbar-end">
                <div class="navbar-item has-dropdown is-hoverable">
                    <a class="navbar-link" id="name">
                        <i class="fa fa-fw fa-user"></i> ชื่อผู้ใช้
                    </a>

                    <div class="navbar-dropdown">
                        <a class="navbar-item" href="../ล็อกอิน.html">
                            ออกจากระบบ
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <br>
    <div class="modal">
            <div class="modal-background"></div>
            <div class="modal-content">
              <p class="image is-4by3">
                <img src="https://bulma.io/images/placeholders/1280x960.png" alt="">
              </p>
            </div>
            <button class="modal-close is-large" aria-label="close"></button>
          </div>
    <div class="container">
        <table class="table is-striped" id="employeeList">
            <thead>
                <tr>
                    <th>ชื่อ</th>
                    <th>นามสกุล</th>
                    <th>วัน/เดือน/ปี เกิด</th>
                    <th>เพศ</th>
                    <th>เลขประจำตัวประชาชน</th>
                    <th>Email</th>
                    <th>Username</th>
                    <th>Password</th>
                    <th>ที่อยู่</th>
                    <th>ตำบล</th>
                    <th>อำเภอ</th>
                    <th>จังหวัด</th>
                    <th>รหัสไปรษณีย์</th>
                    <th>เบอร์โทรศัพท์</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
        <br>
        <button class="button" onclick="openForm()">กรอกข้อมูลพนักงาน</button>
        <div class="form-popup" id="myForm">
            <form onsubmit="event.preventDefault();onFormSubmit();">
                <div>
                    ชื่อ <input type="text" maxlength="20" id="name" class="inputIce">
                </div>
                <div>
                    นามสกุล <input type="text" maxlength="20" id="lastname" class="inputIce">
                </div>
                <div>
                    วัน/เดือน/ปี เกิด
                    <input type="date" id="datepicker" class="inputIce">
                </div>
                <div>

                    เพศ
                    <div>
                        <select id="sex" style="width: 460px" class="selectIce">
                            <option value="ชาย">ชาย</option>
                            <option value="หญิง">หญิง</option>
                            <option value="อื่นๆ">อื่นๆ</option>
                        </select>
                    </div>
                </div>
                <div>เลขประจำตัวประชาชน <input class="inputIce" type="text" id="id" maxlength="13"
                        onkeypress="return isNumber(event);">
                </div>
                <div>
                    Email <input class="inputIce" type="text" id="email" onchange="checkEmail()" maxlength="20">
                </div>
                <div>
                    Username <input class="inputIce" type="text" maxlength="20" id="username">
                </div>
                <div>
                    Password <input class="inputIce" type="text" id="password" maxlength="20">
                </div>
                <div>
                    แผนก
                    <div>
                        <select id="department" style="width: 460px" class="selectIce">
                            <option value="ขายรถ">ขาย</option>
                            <option value="ซื้อรถ">ซื้อ</option>
                            <option value="เดินทะเบียน">เดินทะเบียน</option>
                            <option value="ซ่อม">ซ่อม</option>
                        </select>
                    </div>
                </div>
                <div>ที่อยู่ <input class="inputIce" type="text" maxlength="30" id="address">
                </div>
                <div>ตำบล <input class="inputIce" type="text" maxlength="20" id="tumbon">
                </div>
                <div>อำเภอ <input class="inputIce" type="text" maxlength="20" id="aumper">
                </div>
                <div>จังหวัด <input class="inputIce" type="text" maxlength="20" id="city">
                </div>
                <div>รหัสไปรษณีย์ <input class="inputIce" type="text" id="post" maxlength="5"
                        onkeypress="return isNumber(event);">
                </div>
                <div>เบอร์โทรศัพท์ <input class="inputIce" type="text" id="tel" maxlength="10"
                        onkeypress="return isNumber(event);">
                </div>
                <div>
                    <button class="buttonIce buttonIce1" type=" submit">Submit</button>
                    <button class="buttonIce buttonIce1" type=" button"
                        onclick="event.preventDefault();closeForm()">Close</button>
                </div>

        </div>
        </form>

    </div>
    
</body>

</html>